
http://ipgeobase.ru/

ДДОС: Последовательность действий.

1. Определили на что направлена.
Выяснилось на веб-сервис.
2. Посмотрели что именно за запросы так часто приходят

tcpdump -n -s 2048 -w - port 80 | strings | egrep -i "^(get|host)"

tcpdump -n -s 2048 -w - port 80 | strings | egrep -i "^(get /index)"
tcpdump -n -s 2048 -w - port 80 | strings | egrep -i "^(get /par)"

tcpdump -n -s 2048 -w - port 80 | strings | egrep -i "(jad|jar)"

tcpdump -n -s 2048 -w - port 80 | strings | egrep -i "^(get)"

tcpdump -n -s 2048 -w - port 80 | strings  

По результатц выяснили на какой хостинг направлена атака и какая строка запроса к апачу.
3. Сканировали каждые 5 минут access_log на наличие айпи адресов запрашивающих именно этот url очень активно (потом более ограничили, запрашивающих за интервал только этот урл).
Получали список адресов за последние 5 минут.
4. Полученный список адресов заносили в файервол.
После пяти циклов пунктов 3 и 4 нагрузка резко снизилась. Дальше сканировали в 10 минутном интервале. В течении первого часа обнаружили около половины адресов. Дальше запустили скрипты, которые выполняли действия автоматом. Через пять часов, добавление шло по одному двум адресам.

За первые два часа действий апач перестал ругаться на нехватку ресурсов.

тема про защиты от ддос: есть очень хорошие ссылки на серьёзные компании, полюбому стоит читать
http://forum.profit-partner.ru/viewtopic.php?t=1509&postdays=0&postorder=asc&start=60

Защита от DoS атак в nginx:

> Кто-нибудь занимался борьбой с такими DoS аттаками на уровне nginx?
> Если не жалко - поделитесь идеями. Скоро переедет ко мне несколько
> сайтов которые периодически валят, надо подготовится...

Далее: http://www.opennet.ru/base/net/ddos_nginx.txt.html